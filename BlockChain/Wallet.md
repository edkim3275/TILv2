# WALLET π”

## Self Q&A

### ν†µν•©μ§€κ°‘ κ°λ°μ— λ€ν• κ³ μ°°

- ν„μ¬ κ°λ°ν•λ ¤λ” λΈ”λ΅μ²΄μΈ μ›”λ ›μ€ HD(Hierarchical Deterministic) wallet

- HD μ§€κ°‘μ€ μ—¬λ¬ κ°μ μ£Όμ†λ¥Ό κ΄€λ¦¬ν•κ³ , κ° μ£Όμ†λ” κ²½λ΅μ™€ μΈλ±μ¤λ¥Ό ν†µν•΄ μ λ„λ¨

- λ”°λΌμ„ μ—¬νƒ€ λ‹¤λ¥Έ λ„¤νΈμ›ν¬μ—μ„ μƒμ„±ν• μ§€κ°‘μ„ κ°€μ Έμ¤κΈ° μ„ν•΄μ„λ” ν•΄λ‹Ή μ§€κ°‘μ κ°μΈν‚¤, κ²½λ΅μ™€ μΈλ±μ¤κ°€ ν•„μ”

- μΌλ°μ μΈ κ²½λ΅λ” μ•„λμ™€ κ°™μ€ ν•μ‹μ„ κ°€μ§

  `m / purpose' / coin_type' / account' / change / address_index`

  ex) `m/44'/60'/0'/0/0`

  `m`μ€ λ§μ¤ν„° ν‚¤λ¥Ό λ‚νƒ€λ‚΄κ³ , `44'`λ” BIP-44μ κ²½λ΅ λ“±μ„ λ‚νƒ€λƒ„. λ‹¤λ¥Έ κ²½λ΅ μ •λ³΄λ„ μμ„ μ μκ³ , κ° κ²½λ΅λ” λ‹¤λ¥Έ μ£Όμ†λ¥Ό μƒμ„±ν•¨

- λ©”νƒ€λ§μ¤ν¬ TEST

  > κ·Έλ ‡λ‹¤λ©΄ λ©”νƒ€λ§μ¤ν¬λ” μ–΄λ– ν• κ²½λ΅λ΅ μ§€κ°‘μ„ μƒμ„±ν•κ³  μμ„κΉ

  - μΌλ‹¨ λ©”νƒ€λ§μ¤ν¬λ” κ³„μ •λ§λ‹¤ κ°μΈν‚¤κ°€ λ¨λ‘ λ‹¤λ¥΄λ‹¤λ” κ²ƒμ„ μ• μ μμ—μ(μƒμ„±λ κ³„μ •λ§λ‹¤ κ³ μ μ κ°μΈν‚¤ λ¶€μ—¬)

  - μ¦‰, λ©”νƒ€λ§μ¤ν¬ μ§€κ°‘μ— λ€ν• λ§μ¤ν„°ν‚¤(λ³µκµ¬κµ¬λ¬Έ)κ°€ μ΅΄μ¬ν•κ³  ν•΄λ‹Ή λ§μ¤ν„°ν‚¤λ΅ νμƒλλ” κ°μΈν‚¤κ°€ μ΅΄μ¬

  - κ³„μ •μ¶”κ°€λ΅μ§

    λ§μ¤ν„°ν‚¤λ΅ μƒμ„±λ μ§€κ°‘μ κ²½λ΅λ΅λ¶€ν„° μΈλ±μ¤κ°€ 1μ”© λ”ν•΄μ§€λ©΄μ„ μƒμ„±μ΄λ¨

    ```javascript
    const { ethers } = require('ethers');
    
    const recoverPhrase = '12κ° νΉμ€ 24κ°μ λ³µκµ¬κµ¬λ¬Έ(λ‹¨μ–΄)';
    
    // first wallet from masterkey
    const masterWallet = ethers.HDNodeWallet.fromPhrase(recoverPhrase);
    // second wallet from privatekey
    const childWallet = ethers.HDNodeWallet.fromMnemonic(recoverPhrase, "m/44'/60'/0'/0/1")
    ```

- λ‚¨μ•„μλ” κ¶κΈμ¦ λ° κ°μ„ μ 

  - κ°€μ Έμ¨ μ§€κ°‘κ³Ό κΈ°μ΅΄ μ§€κ°‘κ³Όμ ν¨κ³Όμ μΈ κµ¬λ¶„ λ°©λ²•μ€ λ¬΄μ—‡μΌμ§€
  - (λ¶€λ¦¬λ μ›”λ ›) λ©€ν‹° μ½”μΈ μ§€κ°‘ vs. μ²΄μΈλ³„ μ§€κ°‘


### λ©€ν‹° μ½”μΈ μ§€κ°‘

- λ΅λ”λ‹¤μ—μ„ κ°λ°ν•κ³ μλ” λΈλ¦¬λ μ›”λ ›μ—μ„λ” λ‹¤μ–‘ν• λ„¤νΈμ›ν¬μ—μ„ μ‚¬μ©λλ” μ½”μΈμ„ ν†µν•© κ΄€λ¦¬ν•  μ μλ” λ©€ν‹° μ½”μΈ μ§€κ°‘μ„ μ κ³µ

- μ–΄λ– ν• λ°©μ‹μΌλ΅ ν•΄λ‹Ή μ„λΉ„μ¤λ¥Ό μ κ³µν•λ”κ±ΈκΉ μƒκ°ν•΄λ³΄λ©΄

  - μ²μ νμ›κ°€μ… μ‹(ν΄λ€ν° λ³ΈμΈμΈμ¦, λ΅κ·ΈμΈ λΉ„λ°€λ²νΈ λ“±μ μ •λ³΄μ…λ ¥) λ§μ¤ν„°ν‚¤λ¥Ό λ°κΈ‰ν•κ³  ν•΄λ‹Ή ν‚¤λ¥Ό λ””λ°”μ΄μ¤μ— μ €μ¥
  - λ§μ¤ν„°ν‚¤μ— λ€ν• λ””λ°”μ΄μ¤ μ €μ¥μ κ²½μ°
    - λ¨λ°”μΌ λ””λ°”μ΄μ¤μ κ²½μ° μ•μ „ν• μ €μ¥μ†λ‚ ν‚¤μ²΄μΈμ— μ•”νΈν™”λ κ°μΈν‚¤λ¥Ό μ €μ¥
    - μ•μ „ν• μ €μ¥μ†λ” iOS κΈ°κΈ°μ κ²½μ° Secure Enclaveμ΄λ‚ Android κΈ°κΈ°μ κ²½μ° Strongboxλ¥Ό μ‚¬μ©ν•  μ μμ
    - λ€λ¶€λ¶„μ λ¨λ°”μΌ μ΄μμ²΄μ μ—μ„ κ°μΈν‚¤λ¥Ό μ•μ „ν•κ² μ €μ¥ν•κΈ° μ„ν•΄ ν‚¤μ²΄μΈμ„ ν™μ©. ν‚¤μ²΄μΈμ€ κ°λ°μκ°€ μ ‘κ·Όν•  μ μ—†κ³  μ•μ „ν• μ•”νΈν™”λ¥Ό μ κ³µ
    - μ•λ“λ΅μ΄λ“μ κ²½μ° Android KeystoreλΌκ³ , μ•λ“λ΅μ΄λ“ μ΄μμ²΄μ μ—μ„ κ°μΈν‚¤λ¥Ό μ•μ „ν•κ² μ €μ¥ν•κΈ° μ„ν• μ‹μ¤ν… μμ¤€μ μ €μ¥μ†λ¥Ό μ κ³µ
  - λ©€ν‹° μ½”μΈ μ§€κ°‘μ€ λ§μ¤ν„°ν‚¤λ΅ λ„¤νΈμ›ν¬μ— λ”°λ¥Έ κ³µκ°ν‚¤ λ° μ£Όμ†λ¥Ό μƒμ„±ν•μ—¬ μ κ³µν•λ” λ„¤νΈμ›ν¬μ μ§€κ°‘μ„ μƒμ„±(ν•λ‚μ λ©€ν‹° μ½”μΈ μ§€κ°‘μ€ μ κ³µν•λ” λ„¤νΈμ›ν¬ μΆ…λ¥μ— λ€ν• μ½”μΈ κ΄€λ¦¬κ°€ κ°€λ¥)
  - μ €μ¥λ λ§μ¤ν„°ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ¶”κ°€ λ©€ν‹° μ½”μΈ μ§€κ°‘μ„ μƒμ„±
  - μ§€κ°‘ κ°€μ Έμ¤κΈ°μ κ²½μ°
    - κ°€μ Έμ¤λ ¤λ” μ§€κ°‘μ λ„¤νΈμ›ν¬λ¥Ό μ„ νƒ ν›„, ν•΄λ‹Ή μ§€κ°‘μ κ°μΈν‚¤λ¥Ό μ…λ ¥ν•λ―€λ΅ μ‚¬μ „μ— μ—…λ¬΄ ν‘μ•½μ΄ λ§Ίμ–΄μ Έ μκ±°λ‚, λ΅λ”λ‹¤ μΈ΅μ—μ„ νμ•…λ μ§€κ°‘ κ²½λ΅λ¥Ό ν†µν•΄ ν•΄λ‹Ή μ§€κ°‘μ„ μ¬μƒμ„±ν•λ” κ²ƒμ΄ κ°€λ¥ν•μ§€ μ•μ„κΉ μ¶”μΈ΅λ¨

- κ·Έλ ‡λ‹¤λ©΄ μ›Ήμ—μ„ μ κ³µν•λ” λΈ”λ΅μ²΄μΈ μ§€κ°‘μ κ²½μ° κ°μΈν‚¤λ¥Ό μ–΄λ””μ— λ³΄κ΄€ν•  μ μμ„κΉ

  - λ΅μ»¬ μ¤ν† λ¦¬μ§€μ— μ•”νΈν™”λ ν‚¤μ¤ν† μ–΄λ¥Ό μ €μ¥ν•  μ μμΌλ‚ λΈλΌμ°μ €μ μ·¨μ•½μ μ΄λ‚ λ³΄μ• λ¬Έμ λ΅ μ„ν—ν•  μ μμ

    ```javascript
    // κ°μΈν‚¤ μ €μ¥ ν•¨μ
    function storePrivateKey(encryptedPrivateKey) {
      // λ΅μ»¬ μ¤ν† λ¦¬μ§€μ— μ•”νΈν™”λ κ°μΈν‚¤ μ €μ¥
      localStorage.setItem('encryptedPrivateKey', encryptedPrivateKey);
    }
    ```

  - λΈλΌμ°μ € ν™•μ¥ ν”„λ΅κ·Έλ¨μ—μ„ κ°μΈν‚¤λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ν•κ³  μ•”νΈν™”ν•  μ μμ

    - λΈλΌμ°μ € ν™•μ¥ ν”„λ΅κ·Έλ¨μ΄ μ§€μ›ν•λ” μ•μ „ν• μ¤ν† λ¦¬μ§€λ‚ λΈλΌμ°μ €μ ν™•μ¥ μ¤ν† λ¦¬μ§€λ¥Ό μ‚¬μ©ν•λ©΄ μ•„λμ™€ κ°™μ΄ λ΅μ§μ„ κµ¬μ„±ν•  μ μμ„ κ²ƒ κ°™λ‹¤.

      ```javascript
      // λΈλΌμ°μ € ν™•μ¥ ν”„λ΅κ·Έλ¨μ μ•μ „ν• μ¤ν† λ¦¬μ§€ μ‚¬μ©
      const storage = chrome.storage.local; // Chrome ν™•μ¥ ν”„λ΅κ·Έλ¨ μμ , Firefoxμ™€ κ°™μ€ λ‹¤λ¥Έ λΈλΌμ°μ €λ” λ‹¤λ¥Έ μ¤ν† λ¦¬μ§€ APIλ¥Ό μ‚¬μ©ν•  μ μμ
      
      // κ°μΈν‚¤ μ €μ¥
      const storePrivateKey = (encryptedPrivateKey) => {
        const data = { privateKey: encryptedPrivateKey };
        
        storage.set(data, () => {
          if (chrome.runtime.lastError) {
            console.error('Error storing private key: ' + chrome.runtime.lastError);
          } else {
            console.log('Private key stored successfully');
          }
        })
      }
      
      // κ°μΈν‚¤ λ΅λ“
      const loadPrivateKey = (callback) => {
        storage.get(['privateKey'], (result) => {
          const encryptedPrivateKey = result.privateKey || null;
          callback(encryptedPrivateKey);
        })
      }
      
      // κ°μΈν‚¤ λ΅λ“ λ° λ³µνΈν™”
      loadPrivateKey(function(encryptedPrivateKey) {
        if (encryptedPrivateKey) {
          const decryptedPrivateKey = decrypt(encryptedPrivateKey, password);
          console.log('Loaded and decrypted Private Key:', decryptedPrivateKey);
        } else {
          console.error('Private Key not found.');
        }
      });
      ```

    - μΌλ¶€ λΈλΌμ°μ € ν™•μ¥ ν”„λ΅κ·Έλ¨μ€ μ•”νΈ κ΄€λ¦¬μ™€ κ΄€λ ¨λ μ¶”κ°€ λ³΄μ• κΈ°λ¥μ„ μ κ³µν•  μ μμ. μλ¥Ό λ“¤μ–΄, μ•μ „ν• λΉ„λ°€λ²νΈ μƒμ„±, 2λ‹¨κ³„ μΈμ¦, μƒμ²΄ μΈμ‹ κΈ°μ  λ“±μ„ ν†µν•΄ λ” λ†’μ€ λ³΄μ• μμ¤€μ„ μ κ³µν•λ” κ²½μ°κ°€ μμµλ‹λ‹¤.

  - κ°μΈν‚¤λ¥Ό ν•λ“μ›¨μ–΄ μ§€κ°‘μ— μ €μ¥ν•μ—¬ νΈλμ­μ…μ„ μ„λ…ν•κ±°λ‚ κΈ°νƒ€ μ‘μ—…μ„ μν–‰ν•  λ• ν•λ“μ›¨μ–΄ μ§€κ°‘μ„ μ—°κ²°ν•μ—¬ κ°μΈν‚¤λ¥Ό ν™μ©ν•  μ μμ
