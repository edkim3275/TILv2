# package manager

## npm과 yarn

- 종속성을 관리하고 속도 측면에 차이가 존재하기에 선호도에 따라서 사용을 하면된다고만 알고있었는데, 동일 프로젝트에서 어떤 팀원은 `npm`을 사용하고 또 다른 팀원은 패키지 매니저로 `yarn`을 사용하고있는 상황이 발생해서 해당 부분에 이상을 없을 지 궁금하여 찾아보게 됨.

- `npm`과 `yarn`은 자바스크립트 런타임 환경인 노드(Node.js)의 패키지 관리자. 전 세계 개발자들이 JS로 만든 다양한 패키지를 npm 데이터베이스에 올리면 `npm`, `yarn`과 같은 패키지 관리자를 통해 설치 및 삭제가 가능. 또한 CLI를 통해 패키지 설치 및 삭제 뿐만 아니라 패키지 버전 관리, 의존성 관리도 가능하다.

  `npm`과 `yarn` 둘 다 프로젝트의 의존성을 관리하고 `node_modules` 디렉토리에 필요한 패키지들을 설치하는 패키지 관리 도구.

- npm(Node Package Manager)

  노드를 설치할 때 자동으로 설치되는 기본 패키지 관리자.

  1. 사람들이 노드 패키지를 만들고, 업로드하고, 공유할 수 있는 공간으로써의 온라인 플랫폼 역할
  2. 온라인 플랫폼과 상호 작용하기 위해 CLI를 사용하며 패키지 설치 및 제거가 가능

- npm 설치

  `npm`은 노드를 다운로드하면 시스템에 자동으로 설치됨. 설치 유무 확인은 아래와 같은 명령을 통해 확인 가능

  ```bash
  $ node -v
  $ npm -v
  ```

- yarn

  `yarn`은 16년도 페이스북에서 개발한 패키지 관리자. `npm` 레지스트리와 호환하면서 속도나 안정성 측면에서 npm보다 향상됨

- yarn 설치

  `yarn`은 `npm`을 통해 설치함

  ```bash
  $ npm installl yarn --global
  ```

- 차이?

  1. 속도

     패키지 설치 프로세스를 처리하는 방법에 차이가 있음. `npm`은 패키지를 한 번에 하나씩 순차적으로 설치. 그에 비해 `yarn`은 여러 패키지를 동시에 가져오고 설치하도록 최적화되어 있어 패키지 설치 속도 측면에서 `yarn`이 `npm`보다 빠름

  2. 보안

     `yarn`이 보안 측면에서 `npm` 보다 더 안전한 것으로 알려져 있음. `npm`은 자동으로 패키지에 포함된 다른 패키지 코드를 실행하는데, 이로 인해 보안 시스템에 몇 가지 취약성이 발생하며 나중에 심각한 문제가 발생할 수 있음. 반면에 `yarn`은 yarn.lock 혹은 package.json파일에 있는 파일만을 설치한다.

     :bulb: 보안은 `yarn`의 핵심 기능 중 하나라고 볼 수 있지만 최근에는 `npm` 보안 업데이트도 크게 향상되었음.

  3. 명령어([캡틴판교 블로그](https://joshua1988.github.io/vue-camp/package-manager/npm-vs-yarn.html#npm%E1%84%80%E1%85%AA-yarn%E1%84%8B%E1%85%B4-%E1%84%8E%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%A5%E1%86%B7))

     | 명령어                | npm                                       | yarn                                |
     | --------------------- | ----------------------------------------- | ----------------------------------- |
     | 의존성 설치           | `npm install`                             | `yarn`                              |
     | 패키지 설치           | `npm install <package_name>`              | `yarn add <package_name>`           |
     | 특정 버전 패키지 설치 | `npm install <package_name>@version`      | `yarn add <package_name>@version    |
     | dev 패키지 설치       | `npm install --save-dev <package_name>`   | `yarn add --dev <package_name>`     |
     | 글로벌 패키지 설치    | `npm install --global <package_name>`     | `yarn global add <package_name>`    |
     | 패키지 제거           | `npm uninsatll <package_name>`            | `yarn remove <package_name>`        |
     | dev 패키지 제거       | `npm uninstall --save-dev <package_name>` | `yarn remove <package_name>`        |
     | 글로벌 패키지 제거    | `npm uninstall --global <package_name>`   | `yarn global remove <package_name>` |
     | 업데이트              | `npm update`                              | `yarn upgrade`                      |
     | 패키지 업데이트       | `npm update <package_name>`               | `yarn upgrade <package_name>`       |

- 두 패키지 관리자에 대한 차이 결론

  `npm`, `yarn` 모두 종속성을 관리하고 패키지를 관리하기 좋은 툴. 둘 다 지속적으로 관리 되고 있으며 폭넓은 사용자 커뮤니티를 갖고 있고, 업데이트를 통해 추가된 기능 덕분에 거의 차이가 나지 않음. 따라서 개인 취향, 성능, 커뮤니티에 따라 달라질 수 있다고 봄

- 다시 돌아와서 현 상황에 대한 정리(서로 다른 패키지 관리자를 사용할 때 일어날 수 있는 점)

  1. 의존성 버전 충돌

     `yarn`와 `npm`은 의존성을 저장하고 버전을 관리하는 방식이 약간 다름. 따라서 의존성 버전 충돌이 일어날 수 있음. 이는 개발 및 프로덕션 환경 간에 일관된 패키지 버전을 유지하려는 경우에 문제가 될 수 있음

  2. lock 파일의 차이

     yarn의 경우 `yarn.lock`파일을 사용하고, npm은 `package-lock.json` 파일을 사용함. 해당 두 파일은 의존성을 정확하게 잠그기 위해서 사용하는데, 서로 다른 패키지 관리자를 사용하면 이러한 파일들이 달라질 수 있으며, 이는 프로젝트 의존성 동기화에 영향을 미칠 수 있음

     - `yarn.lock`

       yarn이 패키지를 설치할 때, `yarn.lock`파일이 생성 됨. 이 파일은 패키지 버전의 정확한 복사본을 포함하기에 다른 팀원들이 동일한 의존성 버전을 얻을 수 있도록 도와줌.

     - `package-lock.json`

       npm이 패키지를 설치할 때 `package-lock.json`파일이 생성 됨. 

     - 위 두 파일들은 주로 프로젝트의 일관성과 안정성을 유지하기 위해 사용되며, 특히 여러 환경에서 프로젝트를 실행할 때 발생할 수 있는 버전 충돌을 방지함. 즉, 이러한 잠금 파일을 프로젝트 버전 관리 시스템에 커밋하여 팀원들 간에 일관된 의존성을 보장할 수 있게된다.

       이러한 파일들은 프로젝트의 의존성을 정확하게 기록하고, 동일한 버전의 패키지를 여러 환경에서 일관되게 유지하는 데 중요하다.

     - 패키지 관리자는 일반적으로 아래와 같은 순서로 동작함

       1. 의존성 설치

          `package.json`에 명시된 의존성들을 설치

          이때, 각 패키지의 정확한 버전 정보가 `yarn.lock` 혹은 `package-lock.json`파일에 기록

       2. 의존성 잠금

          설치된 패키지들의 버전 정보를 해당 파일에 기록하여, 다음에 같은 의존성을 설치할 때 동일한 버전을 사용할 수 있도록 함.

       3. node_modules 디렉토리 생성

          의존성이 해결되면, 패키지 관리자는 node_modules 디렉토리를 생성하고, 여기에 필요한 패키지들을 다운로드 함.

       따라서 `package.json` 파일 만으로는 정확한 의존성 버전을 유지하기 어렵다. 이러한 잠금 파일들을 프로젝트의 버전 관리 시스템에 포함하여 모든 팀원들이 동일한 의존성을 유지하도록 하는 것이 좋다.

  3. 명령어의 차이

     `yarn`과 `npm`은 명령어가 약간 차이가 있음. 팀원 간에 일관된 명령어 사용을 유지하는 것이 중요하기에 한 가지로 통일시킬 필요가 있음

  4. 스크립트의 일관성

     프로젝트의 스크립트가 다를 경우 팀원들이 일관된 방식으로 프로젝트를 실행하지 못할 수 있음. 스크립트의 일관성을 유지하면 팀원들 간에 협업이 더 수월해질 수 있음

  5. 환경 변수 및 구성의 관리

     패키지 관리자의 선택은 환경 변수 및 구성 파일 관리에도 영향을 미칠 수 있음.(예 : 환경 변수를 설정하는 방식이나 구성 파일의 위치 등이 서로 다를 수 있음.)